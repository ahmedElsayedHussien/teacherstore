<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <title>مجموعاتي</title>
</head>
<body class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h5 m-0">مجموعاتي</h1>
  <div class="d-flex gap-2">
    <a class="btn btn-success btn-sm" href="{% url 'core:group_create' %}">+ إنشاء مجموعة</a>
    <a class="btn btn-outline-secondary btn-sm" href="{% url 'core:dashboard' %}">الرجوع للداشبورد</a>
  </div>
</div>

  <table class="table table-sm align-middle">
    <thead>
      <tr>
        <th>الاسم</th>
        <th>السنة الدراسية</th>
        <th>المادة</th>
        <th class="text-center">طلاب</th>
        <th class="text-center">حصص قادمة</th>
        <th class="text-center">فواتير هذا الشهر (مستحق/متأخر)</th>
        <th class="text-end">إجراءات</th>
      </tr>
    </thead>
    <tbody>
      {% for r in rows %}
      <tr>
        <td>{{ r.obj.name }}</td>
        <td>{% if r.obj.academic_year %}{{ r.obj.academic_year.name }}{% else %}—{% endif %}</td>
        <td>{% if r.obj.subject %}{{ r.obj.subject.name }}{% else %}—{% endif %}</td>
        <td class="text-center">{{ r.students }}</td>
        <td class="text-center">{{ r.upcoming }}</td>
        <td class="text-center">
          {% if r.due_invoices > 0 %}
            <span class="badge bg-warning text-dark">{{ r.due_invoices }}</span>
          {% else %}
            <span class="text-muted">0</span>
          {% endif %}
        </td>
        <td class="text-end">
  <a class="btn btn-sm btn-outline-primary" href="{% url 'core:group_students' r.obj.id %}">الطلاب (عرض)</a>
  <a class="btn btn-sm btn-outline-secondary" href="{% url 'core:sessions_list' r.obj.id %}">الحصص</a>
  <a class="btn btn-sm btn-outline-success" href="{% url 'core:assignments_list' r.obj.id %}">الواجبات</a>
  <a class="btn btn-sm btn-warning" href="{% url 'core:group_edit' r.obj.id %}">تعديل المجموعة</a>
  <a class="btn btn-sm btn-dark" href="{% url 'core:group_students_manage' r.obj.id %}">إدارة الطلاب</a>
</td>
      </tr>
      {% empty %}
      <tr><td colspan="7" class="text-center text-muted">لا توجد مجموعات بعد.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</body>
</html>
